<!DOCTYPE html>
<html>
<head>
  <link rel='icon' href='favicon.ico'> </link>
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="apple-touch-startup-image" href="apple-touch-icon.png">
  
  <!--laucher icon in manifest -->
  <link rel="manifest" href="manifest.json">
  <meta charset="utf-8">

  <title>Urban Stack</title>

  <!--http://www.html5rocks.com/en/mobile/mobifying/-->
  <meta name="viewport"
        content="width=device-width,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1"/>

  <!--https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">

  <!-- force webkit on 360 -->
  <meta name="renderer" content="webkit"/>
  <meta name="force-rendering" content="webkit"/>
  <!-- force edge on IE -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="msapplication-tap-highlight" content="no">

  <!-- force full screen on some browser -->
  <meta name="full-screen" content="yes"/>
  <meta name="x5-fullscreen" content="true"/>
  <meta name="360-fullscreen" content="true"/>
  
  <!-- force screen orientation on some browser -->
  <meta name="screen-orientation" content="portrait"/>
  <meta name="x5-orientation" content="portrait">

  <!--fix fireball/issues/3568 -->
  <!--<meta name="browsermode" content="application">-->
  <meta name="x5-page-mode" content="app">

  <!--<link rel="apple-touch-icon" href=".png" />-->
  <!--<link rel="apple-touch-icon-precomposed" href=".png" />-->

  <link id="stylesheet" rel="stylesheet" type="text/css" href="style-mobile.css"/>
  <!-- custom cocos css -->
  <link id="stylesheet" rel="stylesheet" type="text/css" href="style-custom.css"/>
	<script type='text/javascript'>
			window.adsState = 0;
			window["GD_OPTIONS"] = {
						"gameId": "1be64a9ffd6e4a56906edb45a1b280e0",
						"onEvent": function(event) {
								window.dispatchEvent(new CustomEvent(event.name, {}));
								switch (event.name) {
										case "SDK_GAME_START":
												window.focus();
												window.adsState = 2;
												// advertisement done, resume game logic and unmute audio
												break;
										case "SDK_GAME_PAUSE":
												// pause game logic / mute audio
												break;
										case "SDK_GDPR_TRACKING":
												// this event is triggered when your user doesn't want to be tracked
												break;
										case "SDK_GDPR_TARGETING":
												// this event is triggered when your user doesn't want personalised targeting of ads and such
												break;
										case "SDK_REWARDED_WATCH_COMPLETE":
												// this event is triggered when your user completely watched rewarded ad
												break;
								}
						},
				};
				(function(d, s, id) {
						var js, fjs = d.getElementsByTagName(s)[0];
						if (d.getElementById(id)) return;
						js = d.createElement(s);
						js.id = id;
						js.src = 'main.min.js';
						fjs.parentNode.insertBefore(js, fjs);
				}(document, 'script', 'gamedistribution-jssdk'));
			</script>
</head>
<body>
		<!-- <script src="//play.ludigames.com/js/cookieconsent.js" charset="utf-8"></script> -->
	<!-- gtm and ads init -->    
    <script type='text/javascript'>
				document.addEventListener('keydown', function(event) {
					event.preventDefault();
				});
				window.playAds = function(){};
				var enableADS = !true;
  /*      var enableADS = !true;
        dataLayer = [];
        var productKey = "";
				var productTitle = "Urban Stack"; // for tracking game name
        var gtmID = "";
        if (enableADS)
        {
            gtmID = 'GTM-PLZ2PKZ'; //
			productKey = "urbanStackFree";
			var adsSDK_url = '../js/games_lib/adsSDK/adsSDK.js'
			var adsSDK_gameConfigUrl = '../js/games_lib/adsSDK/game_config.js'
			var ima3Url = '//imasdk.googleapis.com/js/sdkloader/ima3.js'
			
			dataLayer.push({
			  'publisher' :  'GAMELOFT', // This is the short name of the publisher. Example: GAMELOFT
			});
        }
        else
        {
            gtmID = 'GTM-K74X66';
			productKey = "urbanStack";
			
			dataLayer.push({
			  'event': 'pageLoad',
			  'publisher' :'GAMELOFT',
			});
        }

        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', gtmID);*/
        
	</script>    
    <script src="i18n-supported-languages.js" charset="utf-8"></script>
    <!-- common functions -->
    <script type='text/javascript'>
        function insertScript(d, s, id, url) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {
                return;
            }
            js = d.createElement(s);
            js.id = id;
            js.src = url;
            fjs.parentNode.insertBefore(js, fjs);
        }

        function loadOrderScript(url1, url2, url3) {
            var script1 = document.createElement('script');
            script1.setAttribute('src', url1);
            script1.onload = function() {
                if (typeof(url2) != 'undefined') {
                    var script2 = document.createElement('script');
                    script2.setAttribute('src', url2);
					script2.onload = function() {						
						if (typeof(url3) != 'undefined') {
							var script3 = document.createElement('script');
							script3.setAttribute('src', url3);
							document.body.appendChild(script3);
						}
					}
                    document.body.appendChild(script2);
                }
            }
            document.body.appendChild(script1);
        }

        function getBrowserName() {
            var uAgent = navigator.userAgent;
            var browserName = "unknown";
            // In Opera 15+, the true version is after "OPR/" 
            if (uAgent.indexOf("OPR/") != -1) {
                browserName = "Opera";
            }
            // In older Opera, the true version is after "Opera" or after "Version"
            else if (uAgent.indexOf("Opera") != -1) {
                browserName = "Opera";
            }
            // In MSIE, the true version is after "MSIE" in userAgent
            else if (uAgent.indexOf("MSIE") != -1) {
                browserName = "Microsoft Internet Explorer";
            }
			// In Samsung
			else if (uAgent.indexOf("SamsungBrowser") != -1) {
				browserName = "SamsungBrowser";
			}
            // In Chrome, the true version is after "Chrome" 
            else if (uAgent.indexOf("Chrome") != -1) {
                browserName = "Chrome";
            }
            // In Safari, the true version is after "Safari" or after "Version" 
            else if (uAgent.indexOf("Safari") != -1) {
                browserName = "Safari";
            }
            // In Firefox, the true version is after "Firefox" 
            else if (uAgent.indexOf("Firefox") != -1) {
                browserName = "Firefox";
            }
            return browserName;
        }

        function getChromeMajorVersion() {
            var uAgent = navigator.userAgent;
            var offset = uAgent.indexOf("Chrome");
            return parseInt(uAgent.substring(offset + 7, offset + 9));
        }
		
		function setCookie(cname,cvalue) {
			var d = new Date();
			d.setTime(d.getTime() + (1*365*24*60*60*1000));
			var expires = "expires=" + d.toGMTString();
			document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
		}
		function getCookie(cname) {
			var name = cname + "=";
			var decodedCookie = decodeURIComponent(document.cookie);
			var ca = decodedCookie.split(';');
			for(var i = 0; i < ca.length; i++) {
			  var c = ca[i];
			  while (c.charAt(0) == ' ') {
				c = c.substring(1);
			  }
			  if (c.indexOf(name) == 0) {
				return c.substring(name.length, c.length);
			  }
			}
			return "";
		}
		<!-- function getReferrer(){ // also save to cookie  -->
			<!-- window.referrer = getCookie("root_referrer"); -->
			<!-- if(window.referrer != ""){			   -->
			  <!-- console.log("referal"+window.referrer); -->
			<!-- }else{ -->
			  <!-- var ref = document.referrer; -->
			  <!-- if(ref!=""){ -->
				<!-- setCookie("root_referrer",ref); -->
				<!-- window.referrer = ref; -->
			  <!-- }else{ -->
				<!-- var ser_url= window.location.search; -->
				<!-- window.referrer = "https://play.ludigames.com" + ser_url; -->
			  <!-- } -->
			  <!-- console.log("redirect to play.ludigames.com" + window.referrer); -->
			<!-- } -->
			<!-- return window.referrer; -->
		<!-- } -->
		<!-- getReferrer(); -->
    </script>
    <!-- common functions end -->
	
    <!-- ads --> 

    <script type='text/javascript'>
        console.log("enableADS: " + enableADS);        
        var lang_load = localStorage.getItem(window.btoa(productKey+"__gamesave-language"));
		if(lang_load == null){
			var currLanguage_load = window.navigator.language;
			currLanguage_load = currLanguage_load ? currLanguage_load : window.navigator.browserLanguage;
			currLanguage_load = currLanguage_load ? currLanguage_load.split("-")[0] : "en";
			var supported_languages_load = window.i18n.supported_languages || [];
			if(supported_languages_load.length > 0 && supported_languages_load.indexOf(currLanguage_load) == -1) {   // system lang not support -> choose the 1st
				currLanguage_load = supported_languages_load[0];
			}
			lang_load = currLanguage_load;
			
		}else{
			lang_load = window.atob(lang_load);
		}
		
		insertScript(document,'script', 'lodingText', lang_load + '.js');
		window.loading_index = 1;
		function setLoadingText(){
			if(document.getElementById("loadingText") && window.i18n.languages){
				document.getElementById("loadingText").innerHTML = window.i18n.languages[lang_load].main["loading_"+window.loading_index];
				window.loading_index += 1;
				if(window.loading_index > 5){
					window.loading_index = 1;
					clearInterval(window.loadingTimer);
				}
			}
		}
		window.loadInterval = 3000;
		window.loadingTimer = setInterval(setLoadingText, window.loadInterval);
		
		// should load ludi before fb
        ludiSDKAsyncInit = function() {
            console.log("ludiSDKAsyncInit ");                
        };
        // add ludisdk to document
        //insertScript(document,'script', 'ludisdk', '//play.ludigames.com/js/games_lib/ludiSDK.js');            
        
    </script>   
    <!-- ads end -->
  <div id="GameDiv" style="width: 640px; height: 960px; display: none"></div>
  <canvas id="GameCanvas" oncontextmenu="event.preventDefault()" tabindex="0"></canvas>
  <div id="splash">
	<div class="loadingText" id="loadingText"></div>
	<div class="line" id="line">
		<img class="line" src="UI_loading_line.png" >
	</div>
	<div class="load_bg" id="load_bg">
		
	</div>
	<div class="truck" id="truck">
		<img class="truck" src="UI_loading_truck.png" >
	</div>
	
    <!--div class="progress-bar stripes">
      <span style="width: 0%"></span>
    </div-->
  </div>
	<div id="adsContainer" style="margin:0;padding:0;background-color:#000">
	</div>
<script src="src/settings.js" charset="utf-8"></script>

<script src="main.js?v=121" charset="utf-8"></script>
<!-- <script src="post-custom.js" charset="utf-8"></script> -->
</body>
</html>
